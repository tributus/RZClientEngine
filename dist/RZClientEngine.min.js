function StringBuilder(){var strings=[];this.append=function(string){string=verify(string),string.length>0&&(strings[strings.length]=string)},this.appendLine=function(string){if(string=verify(string),this.isEmpty()){if(!(string.length>0))return;strings[strings.length]=string}else strings[strings.length]=string.length>0?"\r\n"+string:"\r\n"},this.appendFormat=function(string){string=verify(string);for(var fstring=string,i=1;i<arguments.length;i++)pattern=new RegExp("\\{"+(i-1).toString()+"}","g"),fstring=fstring.replace(pattern,arguments[i]);string.length>0&&(strings[strings.length]=fstring)},this.appendLineFormat=function(string){string=verify(string);for(var fstring=string,i=1;i<arguments.length;i++)pattern=new RegExp("\\{"+(i-1).toString()+"}","g"),fstring=fstring.replace(pattern,arguments[i]);if(this.isEmpty()){if(!(fstring.length>0))return;strings[fstring.length]=fstring}else strings[strings.length]=string.length>0?"\r\n"+fstring:"\r\n"},this.clear=function(){strings=[]},this.isEmpty=function(){return 0==strings.length},this.toString=function(){return strings.join("")};var verify=function(string){return defined(string)?getType(string)!=getType(new String)?String(string):string:""},defined=function(el){return null!=el&&"undefined"!=typeof el},getType=function(instance){if(!defined(instance.constructor))throw Error("Unexpected object type");var type=String(instance.constructor).match(/function\s+(\w+)/);return defined(type)?type[1]:"undefined"}}function generateRandomID(size){for(var s=void 0===size?8:size,possible="abcdefghijklmnopqrstuvwxyz0123456789_",id="wdgv_",i=0;s>i;i++)id+=possible.charAt(Math.floor(Math.random()*possible.length));return id}Array.prototype.find||(Array.prototype.find=function(predicate){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var value,list=Object(this),length=list.length>>>0,thisArg=arguments[1],i=0;length>i;i++)if(value=list[i],predicate.call(thisArg,value,i,list))return value}),Array.prototype.findIndex||(Array.prototype.findIndex=function(predicate){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof predicate)throw new TypeError("predicate must be a function");for(var value,list=Object(this),length=list.length>>>0,thisArg=arguments[1],i=0;length>i;i++)if(value=list[i],predicate.call(thisArg,value,i,list))return i;return-1}),String.prototype.startsWith=function(str){return 0==this.indexOf(str)};var rz={};rz.engine={},rz.widgets={},rz.plugins={},rz.utils={},rz.helpers={},rz.helpers.StringBuilder=StringBuilder,rz.helpers.generateRandomID=generateRandomID,rz.helpers.ensureFunction=function(f){return void 0===f?function(){}:f};var ruteZangada=function($){var $this=this;return this.extend=function(n,f){$this[n]=f},this.get=function(url,callback){callback=callback||function(){},$.get(url,function(data,status,jqxhr){callback(data,status,jqxhr)}).fail(function(data,status){callback(data,status)})},this.post=function(url,data,callback){throw alert("NOT IMPLEMENTED"),"NOT_IMPLEMENTED"},this.put=function(url,data,callback){throw alert("NOT IMPLEMENTED"),"NOT_IMPLEMENTED"},this["delete"]=function(url,data,callback){throw alert("NOT IMPLEMENTED"),"NOT_IMPLEMENTED"},this}(jQuery),$rzs={s1:"invalid widget format",s2:"NOT_A_FUNCTION",s3:"NO_INITIALIZE_FUNCTION",s4:"NO_RENDER_FUNCTION",s5:"error registering widget",s6:"widget definition not found",s7:"UNKNOWN_WIDGET_DEFINITION",s8:"http://support.rz.com/rzframework/doc/common_errors"};rz.widgets.helpers={widgets:{},widgetsMetaData:{},validateWidgetStructure:function(d){if("function"!=typeof d)throw this.error(1,$rzs.s1,$rzs.s2)},error:function(code,msg,d){return{code:code,message:msg,details:d,helpLink:$rzs.s8+"?code="+code+"&d="+d}},setupWidgetEventHandlers:function(eventData,h){eventData.definition.eventHandlers={},eventData.definition.eventHandlerDescriptions={},void 0!==h&&h.length>0&&h.forEach(function(it){if("string"==typeof it)eventData.definition.eventHandlers[it]=[],eventData.definition.eventHandlerDescriptions[it]={},rz.widgets.helpers.widgetsMetaData[eventData.name].eventInfo[it]={};else{if("object"!=typeof it)throw"invalid event handler definition";eventData.definition.eventHandlers[it.name]=[],eventData.definition.eventHandlerDescriptions[it.name]=it,rz.widgets.helpers.widgetsMetaData[eventData.name].eventInfo[it.name]=it}}),eventData.definition.prototype.on=function(eventName,handler){try{eventData.definition.eventHandlers[eventName].push(handler)}catch(e){throw"invalid event handler"}},eventData.definition.prototype.raiseEvent=function(name,args,sender){var handlers=sender.getEventHandler(name);void 0!==handlers&&handlers.length>0&&handlers.forEach(function(it){it(sender,args)})},eventData.definition.prototype.getEventHandlers=function(){return eventData.definition.eventHandlers},eventData.definition.prototype.getEventHandler=function(name){return eventData.definition.eventHandlers[name]},eventData.definition.prototype.getEventHandlersDescriptions=function(){return eventData.definition.eventHandlerDescriptions},eventData.definition.prototype.getEventHandlersDescription=function(name){return eventData.definition.eventHandlerDescriptions[name]}},setupMethodHandler:function(eventData,methodHandlers){var defaultMHandler=function(){throw"not implemented"};eventData.definition.methodDescriptions={},void 0!==methodHandlers&&methodHandlers.length>0&&methodHandlers.forEach(function(it){if("string"==typeof it)eventData.definition.methodDescriptions[it]={},eventData.definition.prototype[it]=defaultMHandler,rz.widgets.helpers.widgetsMetaData[eventData.name].methodInfo[it]={};else{if("object"!=typeof it||void 0===it.name)throw"incorrect data format";eventData.definition.methodDescriptions[it.name]=it,eventData.definition.prototype[it.name]=defaultMHandler,rz.widgets.helpers.widgetsMetaData[eventData.name].methodInfo[it.name]=it}}),eventData.definition.prototype.getMethodDescriptors=function(){return eventData.definition.methodDescriptions},eventData.definition.prototype.getMethodDescriptor=function(methodName){return eventData.definition.methodDescriptions[methodName]}}},rz.engine.widgetDefinitionMethod=function(n,m,h,d){try{var eventData={name:n,definition:d,methodDeclarations:m,eventHandlers:h,cancel:!1};if(!eventData.cancel)return rz.widgets.helpers.validateWidgetStructure(eventData.definition),rz.widgets.helpers.widgetsMetaData[eventData.name]={},rz.widgets.helpers.widgetsMetaData[eventData.name].methodInfo={},rz.widgets.helpers.widgetsMetaData[eventData.name].eventInfo={},rz.widgets.helpers.setupWidgetEventHandlers(eventData,h),rz.widgets.helpers.setupMethodHandler(eventData,m),rz.widgets.helpers.widgets[eventData.name]=eventData.definition,eventData.definition}catch(err){throw console.error("%O",err),$rzs.s5}},rz.engine.renderWidgetDefinitionMethod=function(w,t,d){var Widget=rz.widgets.helpers.widgets[w];if(void 0===Widget)throw rz.widgets.helpers.error(2,$rzs.s7,$rzs.s6);var widget=new Widget;return widget.initialize(d,function(pd){var ref={renderData:widget.render(t,pd)};return ref}),widget},rz.engine.getWidgetEventHandlersDescriptionsMethod=function(widgetName){return rz.widgets.helpers.widgetsMetaData[widgetName].eventInfo},rz.engine.getWidgetEventHandlersDescriptionMethod=function(widgetName,eventName){return rz.widgets.helpers.widgetsMetaData[widgetName].eventInfo[eventName]},rz.engine.getWidgetMethodsDescriptionsMethod=function(widgetName){return rz.widgets.helpers.widgetsMetaData[widgetName].methodInfo},rz.engine.getWidgetMethodsDescriptionMethod=function(widgetName,methodName){return rz.widgets.helpers.widgetsMetaData[widgetName].methodInfo[methodName]},ruteZangada.extend("widget",rz.engine.widgetDefinitionMethod),ruteZangada.extend("renderWidget",rz.engine.renderWidgetDefinitionMethod),ruteZangada.extend("getWidgetEventHandlersDescriptions",rz.engine.getWidgetEventHandlersDescriptionsMethod),ruteZangada.extend("getWidgetEventHandlersDescription",rz.engine.getWidgetEventHandlersDescriptionMethod),ruteZangada.extend("getWidgetMethodsDescriptions",rz.engine.getWidgetMethodsDescriptionsMethod),ruteZangada.extend("getWidgetMethodsDescription",rz.engine.getWidgetMethodsDescriptionMethod),rz.utils.uri={getSearch:function(url){var fploc=url.indexOf("?");return-1==fploc?"":url.substring(fploc)},getParamCount:function(url){var query=this.getSearch(url);return(query.match(new RegExp(/[\?|&][a-zA-Z0-9+]+=([^&*]*)/g))||[]).length},getParamList:function(url){var query=this.getSearch(url),rawParams=query.match(new RegExp(/([\?|&][a-zA-Z0-9+]+=)/g))||[],oparams=[];return rawParams.forEach(function(it){oparams.push(it.replace(/[?|&|=]/g,""))}),oparams},hasParam:function(url,p){var query=this.getSearch(url);return void 0!==(query.match(new RegExp("[?&]"+p+"=([^&]+)"))||[])[0]},getParamValue:function(url,p){if(this.hasParam(url,p)){var query=this.getSearch(url);return((query.match(new RegExp("[?&]"+p+"=([^&]+)"))||[])[0]||"").replace(/[?|&][a-zA-Z0-9*]+=/g,"")}},mergeParam:function(url,p,v){var paramWithValue=p+"="+v;return this.getParamList(url).length>0?url+"&"+paramWithValue:url+"?"+paramWithValue}},rz.plugins.jsonFilterEngine=function(opt){var getConnector=function(condition){if(void 0===condition.connector)return"&&";switch(condition.connector.toLocaleLowerCase()){case"and":return" && ";case"or":return" || ";case"and not":return" && !";case"or not":return" || !";default:return" && "}},getOperator=function(condition){if(void 0==condition.operator)return"===";switch(condition.operator.toLowerCase()){case"equals":case"=":case"==":case"===":return"===@";case"notequas":case"<>":case"!=":case"!==":return"!==@";case"gt":case">":case"greaterthan":return" > @";case"lt":case"<":case"lessthan":return" < @";case"gte":case">=":case"greaterthanorequal":return" >= @";case"lte":case"<=":case"lessthanorequal":return" >= @";case"startswith":case"::=":return".startsWith(@)";case"endswith":case"=::":return".endsWith(@)";case"contains":case":=:":return".indexOf(@)!=-1";default:return condition.operator}};this.json2filterFunction=function(filterExpression){var filterString="",processNodes=function(nodelist){var blockStart=!0;nodelist.forEach(function(item){blockStart?blockStart=!1:filterString+=getConnector(item),void 0===item.conditions?filterString+="m."+item.field+getOperator(item).replace("@",item.value):(filterString+="(",processNodes(item.conditions),filterString+=")")})};return processNodes(filterExpression),filterString},this.buildFilterFunction=function(filterExpression){var expressionString=this.json2filterFunction(filterExpression),r=function(m){return eval(expressionString)};return r}};